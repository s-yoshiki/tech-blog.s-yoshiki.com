---
title: "Amazon S3 でライフサイクルポリシーを設定する"
path: "/entry/283"
date: "2022-06-19 21:00"
coverImage: "../../../images/thumbnail/aws-logo.png"
author: "s-yoshiki"
tags: ["amazon-aws", "amazon-s3"]
---

## 概要

Amazon S3 でライフサイクルポリシーを設定してみました。

一連の作業の流れについての作業メモです。

## やりたいこと

とあるバケットに対して以下のルールを適用します。

1. バケット内の全てのオブジェクトを対象とする
2. 90日経過後削除する
3. ついでに不完全なマルチパートアップロードオブジェクトも削除する

## マネジメントコンソールから設定する

### 1. マネジメントコンソールに移動

マネジメントコンソールに移動しS3の選択画面に遷移します。

ここで任意のバケットを選択します。

ここでは例として`config-bucket-XXXX`を選択します。

![](./s3_1.png)

### 2. ルール作成

ライフサイクルルール作成ボタンを押下します。

![](./s3_2.png)

### 3. ルール名

適当なルール名を選択します。ここでは`log-90d`とします。

また、接頭辞を利用して対象オブジェクトの絞り込みを行えますが、ここでは全てのオブジェクトに適用します。

![](./s3_3.png)

### 4. ルールのアクションの決定

ルールのアクションを決定します。

今回やりたいことは古いオブジェクトを有効期限切れにした上で削除するように設定します。

従って、ルールは次のように設定しました。

![](./s3_4.png)

### 5. 有効期限の設定

90日として設定します。

![](./s3_5.png)

### 6. マルチパートアップロードのオブジェクト削除

マルチパートアップロードのオブジェクトを削除するように設定します。

![](./s3_6.png)

## 参考にしたサイト

- [s3のライフサイクルルールを設定してみる - Qiita](https://qiita.com/miyuki_samitani/items/cbea495fb116b5bf5db6)
- [S3ライフサイクルルールで古いオブジェクトを自動削除する](https://nakada-r.com/2021/01/s3-lifecycle/)
